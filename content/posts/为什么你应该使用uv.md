---
title: 用Python的你，为什么应该尝试uv
summary: 从脚本迈向工程，你需要一把趁手的武器。
date: 2024-11-21
tags: ["工具探索"]
draft: false
slug: why-you-should-try-uv
cover:
  image: https://github.com/astral-sh/uv/assets/1309177/03aa9163-1c79-4a87-a31d-7a9311ed9310#only-dark
---

## 为什么应该尝试 uv？

### 当一个`.py`不再够用 

使用 Python 无非是为了编写自己的代码，或跑通别人的代码。你会经常遇到一些问题：

- 因为喜欢或被迫，你得使用项目级别的 Python 了。
- 项目可能需要使用不同版本的 Python 解释器，比如 Python 3.6 和 Python 3.12。（2.7？那不应该去博物馆吗？）
- 你可能有强迫症，希望每个项目有自己的环境，爬虫项目只装 requests，深度学习项目只装 PyTorch。
- 你需要记录项目中你用了哪些包，以及它们的版本，以便别人复现你的项目。
- 如果干的不错，你可能希望打包你的项目，分享给别人被夸一夸。
- 有些 Python 写的小工具只是想下载用用，并不想装到哪个环境里。（说你呢 nvitop）

### 那些年，我们用过的工具

**以往我们可以使用很多工具解决这些问题，但它们各有有缺点：**

- pip 可以用来安装包并导出 requirements.txt，但它无法管理虚拟环境。
- conda 可以管理 Python 版本和虚拟环境，但它实际上是为每个环境单独安装 Python，占用磁盘空间而且慢。（想想一下有 10 个python 3.10 在你的电脑上）
- venv 可以创建虚拟环境，但还得我们手动改动版本记录，在有些系统下得装额外的包。
- setuptools 可以打包项目，但它需要我们手动写 setup.py。
- pipx 可以下载小工具，然而你得单独在电脑上照顾一个 pipx。

以上曾经就是我这电脑上要装的东西。最优雅的语言，搭配最麻烦的工具链。

### uv 带来了什么？

**而如今大一统的时代已来，只需一个 uv，你可以：**
- 使用 `uv python` 管理所有 Python 解释器，一个解释器只会装一次。
- 使用 `uv init/add/remove` 启用并管理项目，自动记录依赖，连 .git 都给你准备好。
- 使用 `uv sync` 完美复现别人的项目依赖，或让别人复现你的。
- 使用 `uv venv` 管理虚拟环境，让每个项目享受自由。
- 使用 `uv tool` 无缝替换 pipx。
- 使用 `uv build` 一键打包项目。懒得发布？`uv publish` 自动上传到 PyPI。

**如果以上还没有打动你，还有：**
- 使用 `uv run` 直接运行一个脚本，无需切换环境。
- 使用 `uv pip` 直接替换掉 pip 好了，享受 rust 带来的极致速度和美观的终端输出。
- 使用 `uv tree` 查看项目依赖树。这以往需要`pipdeptree` 或 `pip-tree` 才能实现。

poetry 之类的软件也在试图解决这些问题，但 uv 更加优雅，更加简单，更加全面，更快。

## 如何安装和使用 uv？

[官方文档](https://docs.astral.sh/uv/)永远是最好的参考,动手吧！
